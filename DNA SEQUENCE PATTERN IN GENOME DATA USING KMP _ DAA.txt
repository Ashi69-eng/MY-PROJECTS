<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Gene Pattern Detector | Naive vs KMP</title>
  <style>
* { 
box-sizing: border-box; 
}
body {
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
  background: radial-gradient(circle at top, rgb(230,240,255) 0, rgb(248,250,252) 40%, rgb(238,242,255) 100%);
  color: rgb(15,23,42);
}
.page { max-width: 1100px; margin: 0 auto; padding: 24px 16px 40px; }
header {
  display: flex; justify-content: space-between; align-items: center;
  gap: 12px; margin-bottom: 20px; flex-wrap: wrap;
}
.title-block h1 { margin: 0; font-size: 26px; color: rgb(30,41,59); }
.title-block p { margin: 4px 0 0; font-size: 13px; color: rgb(100,116,139); }
.tag {
  padding: 4px 10px; border-radius: 999px; font-size: 11px;
  text-transform: uppercase; letter-spacing: 0.08em;
  background: rgb(224,242,254); color: rgb(3,105,161); border: 1px solid rgb(186,230,253);
  white-space: nowrap;
}
.layout {
  display: grid; grid-template-columns: minmax(0,2fr) minmax(0,3fr); gap: 16px;
}
@media (max-width: 900px) {
  .layout { grid-template-columns: minmax(0,1fr); }
}
.card {
  background: rgba(255,255,255,0.8); backdrop-filter: blur(6px);
  border-radius: 12px; padding: 14px 14px 16px;
  box-shadow: 0 10px 25px rgba(15,23,42,0.06);
  border: 1px solid rgb(229,231,235); margin-bottom: 12px;
}
.card h2 { font-size: 17px; margin: 0 0 8px; display: flex; align-items: center; gap: 6px; color: rgb(17,24,39); }
.card h3 { font-size: 15px; margin: 0 0 8px; color: rgb(17,24,39); }
.badge {
  font-size: 10px; padding: 2px 7px; border-radius: 999px;
  text-transform: uppercase; letter-spacing: 0.08em;
  background: rgb(238,242,255); color: rgb(79,70,229);
}
label { font-size: 13px; font-weight: 600; color: rgb(55,65,81); display: block; margin-bottom: 4px; }
textarea {
  width: 100%; min-height: 70px; resize: vertical; padding: 8px 10px;
  border-radius: 8px; border: 1px solid rgb(212,212,216);
  font-size: 13px; font-family: "JetBrains Mono", "Cascadia Code", Consolas, monospace;
}
input[type="text"], input[type="number"] {
  width: 100%; padding: 7px 9px; border-radius: 8px;
  border: 1px solid rgb(212,212,216); font-size: 13px;
}
input:focus, textarea:focus {
  outline: none; border-color: rgb(79,70,229);
  box-shadow: 0 0 0 1px rgba(79,70,229,0.1);
}
.row { display: flex; gap: 10px; margin-top: 6px; flex-wrap: wrap; }
.row > div { flex: 1; min-width: 120px; }
button {
  border: none; border-radius: 999px; padding: 8px 18px;
  font-size: 13px; font-weight: 600; cursor: pointer;
  background: linear-gradient(135deg, rgb(79,70,229), rgb(14,165,233));
  color: white; margin-top: 10px;
  box-shadow: 0 6px 18px rgba(37,99,235,0.35);
  transition: transform 0.08s ease, box-shadow 0.08s ease;
}
button:hover {
  transform: translateY(-1px);
  box-shadow: 0 8px 22px rgba(37,99,235,0.4);
}
button:active {
  transform: translateY(0);
  box-shadow: 0 4px 12px rgba(37,99,235,0.3);
}
.pill-info { font-size: 11px; color: rgb(107,114,128); margin-top: 6px; }
.output {
  white-space: pre-wrap; background: rgb(15,23,42); color: rgb(229,231,235);
  padding: 9px 10px; border-radius: 8px; font-family: "JetBrains Mono", monospace;
  font-size: 12px; line-height: 1.5; border: 1px solid rgb(31,41,55);
}
.output-soft {
  background: rgb(249,250,251); color: rgb(17,24,39);
  border-radius: 8px; padding: 10px 11px;
  font-size: 12px; line-height: 1.6; border: 1px dashed rgb(229,231,235);
}
.match { background: rgb(250,204,21); color: rgb(17,24,39); font-weight: 700; padding: 0 1px; border-radius: 3px; }
.highlight-label { font-size: 11px; color: rgb(107,114,128); margin-bottom: 4px; }
.two-col-small { display: flex; flex-wrap: wrap; gap: 10px; }
.two-col-small > div { flex: 1; min-width: 160px; }
.algo-header {
  display: flex; justify-content: space-between; align-items: baseline;
  gap: 8px; margin-bottom: 4px;
}
.algo-header span { font-size: 11px; color: rgb(156,163,175); }
footer {
  text-align: center; margin-top: 24px; font-size: 11px; color: rgb(156,163,175);

    }
  </style>
</head>
<body>
  <div class="page">
    <header>
      <div class="title-block">
        <h1>Gene Pattern Detector</h1>
        <p>Pattern matching on DNA sequences using Naive and KMP algorithms</p>
      </div>
      <div>
        <div class="tag">DAA Mini Project · C + Web Visualization</div>
      </div>
    </header>

    <div class="layout">
      <div>
        <div class="card">
          <h2>1. Input <span class="badge">Genome &amp; Pattern</span></h2>
          <label for="genome">Genome sequence (A / T / G / C only)</label>
          <textarea id="genome" placeholder="Example: ATGCGATATCGATG"></textarea>

          <div class="row">
            <div>
              <label for="pattern">Pattern to search</label>
              <input type="text" id="pattern" placeholder="Example: ATG" />
            </div>
            <div>
              <label for="randomLen">Or generate random genome (length)</label>
              <input type="number" id="randomLen" min="1" max="10000" placeholder="e.g. 50" />
            </div>
          </div>

          <div class="pill-info">
            Tip: Enter a genome and pattern, or leave genome empty &amp; enter a length to auto-generate.
          </div>

          <button onclick="runDetector()">Run Naive &amp; KMP Analysis</button>
        </div>

        <div class="card">
          <h2>2. DNA Statistics</h2>
          <div id="stats" class="output-soft">Waiting for input…</div>
        </div>
      </div>

      <div>
        <div class="card">
          <div class="two-col-small">
            <div>
              <div class="algo-header">
                <h3>Naive Algorithm</h3>
                <span>O(n × m)</span>
              </div>
              <div id="naive" class="output">No data yet.</div>
            </div>
            <div>
              <div class="algo-header">
                <h3>KMP Algorithm</h3>
                <span>O(n + m)</span>
              </div>
              <div id="kmp" class="output">No data yet.</div>
            </div>
          </div>
        </div>

        <div class="card">
          <h2>3. Match Visualization</h2>
          <div class="highlight-label">Matches are highlighted in yellow inside the genome:</div>
          <div id="highlight" class="output-soft">Genome preview will appear here.</div>
        </div>

        <div class="card">
          <h2>4. Summary &amp; Conclusion</h2>
          <div id="summary" class="output-soft">
            Run the detector to see which algorithm was faster and why KMP is theoretically better.
          </div>
        </div>
      </div>
    </div>

    <footer>
      Gene Pattern Detector · Naive vs KMP · Suitable for Design &amp; Analysis of Algorithms project
    </footer>
  </div>

  <script>
    function cleanDNA(s) {
      if (!s) return "";
      s = s.toUpperCase().replace(/\s+/g, "");
      return s;
    }

    function isValidDNA(s) {
      return /^[ATGC]*$/.test(s);
    }

    function gcContent(s) {
      if (!s.length) return "0.00";
      let gc = 0;
      for (let c of s) if (c === "G" || c === "C") gc++;
      return (gc * 100 / s.length).toFixed(2);
    }

    function baseCounts(s) {
      let A = 0, T = 0, G = 0, C = 0;
      for (let c of s) {
        if (c === "A") A++;
        else if (c === "T") T++;
        else if (c === "G") G++;
        else if (c === "C") C++;
      }
      return { A, T, G, C };
    }

    function naiveSearch(text, pattern) {
      let n = text.length, m = pattern.length;
      let positions = [];
      for (let i = 0; i <= n - m; i++) {
        let j = 0;
        while (j < m && text[i + j] === pattern[j]) j++;
        if (j === m) positions.push(i);
      }
      return positions;
    }

    function computeLPS(pattern) {
      let m = pattern.length;
      let lps = new Array(m).fill(0);
      let len = 0, i = 1;
      while (i < m) {
        if (pattern[i] === pattern[len]) {
          len++;
          lps[i] = len;
          i++;
        } else {
          if (len !== 0) {
            len = lps[len - 1];
          } else {
            lps[i] = 0;
            i++;
          }
        }
      }
      return lps;
    }

    function kmpSearch(text, pattern) {
      let n = text.length, m = pattern.length;
      let lps = computeLPS(pattern);
      let positions = [];
      let i = 0, j = 0;
      while (i < n) {
        if (text[i] === pattern[j]) {
          i++; j++;
        }
        if (j === m) {
          positions.push(i - j);
          j = lps[j - 1];
        } else if (i < n && text[i] !== pattern[j]) {
          if (j !== 0) j = lps[j - 1];
          else i++;
        }
      }
      return positions;
    }

    function highlightGenome(genome, pattern, naivePos, kmpPos) {
      if (!genome.length) return "No genome to display.";
      let m = pattern.length;
      let marks = new Array(genome.length).fill(0);
      naivePos.forEach(p => { if (p >= 0 && p < genome.length) marks[p] = 1; });
      kmpPos.forEach(p => { if (p >= 0 && p < genome.length) marks[p] = 2; });

      let html = "";
      for (let i = 0; i < genome.length;) {
        if (marks[i] === 1 || marks[i] === 2) {
          html += "<span class=\"match\">" +
                  genome.substring(i, i + m) +
                  "</span>";
          i += m;
        } else {
          html += genome[i];
          i++;
        }
      }
      return html;
    }

    function runDetector() {
      let genomeInput = document.getElementById("genome").value.trim();
      let patternInput = document.getElementById("pattern").value.trim();
      let randomLen = document.getElementById("randomLen").value.trim();

      let genome = cleanDNA(genomeInput);
      let pattern = cleanDNA(patternInput);

      if (!genome && randomLen) {
        let len = parseInt(randomLen, 10);
        if (isNaN(len) || len <= 0 || len > 10000) {
          alert("Please enter a valid random genome length (1–10000).");
          return;
        }
        const bases = ["A", "T", "G", "C"];
        let generated = "";
        for (let i = 0; i < len; i++) {
          generated += bases[Math.floor(Math.random() * 4)];
        }
        genome = generated;
        document.getElementById("genome").value = generated;
      }

      if (!genome) {
        alert("Please enter a genome sequence or a random length.");
        return;
      }

      if (!pattern) {
        alert("Please enter a pattern to search.");
        return;
      }

      if (!isValidDNA(genome) || !isValidDNA(pattern)) {
        alert("Genome and pattern must contain only A, T, G, C.");
        return;
      }

      if (pattern.length > genome.length) {
        alert("Pattern cannot be longer than genome.");
        return;
      }

      let stats = baseCounts(genome);
      let statsText =
        "Genome length      : " + genome.length + "\n" +
        "Pattern length     : " + pattern.length + "\n" +
        "GC content         : " + gcContent(genome) + "%\n" +
        "Base count         : A=" + stats.A +
        "  T=" + stats.T +
        "  G=" + stats.G +
        "  C=" + stats.C;
      document.getElementById("stats").textContent = statsText;

      let t1 = performance.now();
      let naivePositions = naiveSearch(genome, pattern);
      let t2 = performance.now();
      let naiveTime = (t2 - t1).toFixed(5);

      let naiveOut = "";
      if (naivePositions.length === 0) {
        naiveOut = "Pattern not found.\nTime: " + naiveTime + " ms";
      } else {
        naiveOut =
          "Matches at indices: " + naivePositions.join(", ") + "\n" +
          "Total matches    : " + naivePositions.length + "\n" +
          "Time taken       : " + naiveTime + " ms";
      }
      document.getElementById("naive").textContent = naiveOut;

      let t3 = performance.now();
      let kmpPositions = kmpSearch(genome, pattern);
      let t4 = performance.now();
      let kmpTime = (t4 - t3).toFixed(5);

      let kmpOut = "";
      if (kmpPositions.length === 0) {
        kmpOut = "Pattern not found.\nTime: " + kmpTime + " ms";
      } else {
        kmpOut =
          "Matches at indices: " + kmpPositions.join(", ") + "\n" +
          "Total matches    : " + kmpPositions.length + "\n" +
          "Time taken       : " + kmpTime + " ms";
      }
      document.getElementById("kmp").textContent = kmpOut;

      document.getElementById("highlight").innerHTML =
        highlightGenome(genome, pattern, naivePositions, kmpPositions);

      let nTime = parseFloat(naiveTime);
      let kTime = parseFloat(kmpTime);
      let summary = "";
      summary += "Naive time : " + naiveTime + " ms\n";
      summary += "KMP time   : " + kmpTime + " ms\n\n";

      if (naivePositions.length !== kmpPositions.length) {
        summary += "? Algorithms returned different match counts. Check implementation or input.\n\n";
      }

      if (nTime < kTime) {
        summary += "? For this particular input, the Naive algorithm was faster.\n";
        summary += "   This often happens for very small strings because Naive has less overhead.\n\n";
      } else if (kTime < nTime) {
        summary += "? For this particular input, the KMP algorithm was faster.\n";
        summary += "   KMP avoids re-checking characters using the LPS table, so it scales better.\n\n";
      } else {
        summary += "? For this input, both algorithms took roughly the same time.\n\n";
      }

      summary += "Theoretical time complexities:\n";
      summary += "   • Naive : O(n × m)\n";
      summary += "   • KMP   : O(n + m)\n";
      summary += "\nTherefore, for large genome data or long patterns, KMP is asymptotically better,\n"
               + "even if Naive may win occasionally on tiny test cases.";

      document.getElementById("summary").textContent = summary;
    }
  </script>
</body>
</html>